// Nest Generator
@function pow($number, $exp)
  $value: 1
  @if $exp > 0
    @for $i from 1 through $exp
      $value: $value * $number
  @else if $exp < 0
    @for $i from 1 through -$exp
      $value: $value / $number
  @return $value

=nestle($ratio: 1.5, $shift: -2, $steps: 6)

  @for $step from 1 through ($steps)
    $rank: $steps - ($step - $shift)
    $size: pow($ratio, $rank)

    .pad-#{$step}
      padding:        $size + em
    .pad-h-#{$step}
      padding-right:  $size + em
      padding-left:   $size + em
    .pad-v-#{$step}
      padding-top:    $size + em
      padding-bottom: $size + em
    .pad-t-#{$step}
      padding-top:    $size + em
    .pad-r-#{$step}
      padding-right:  $size + em
    .pad-b-#{$step}
      padding-bottom: $size + em
    .pad-l-#{$step}
      padding-left:   $size + em

    .nest-#{$step}

      > *, 
      &.sub-all *
        margin-top: $size + em
        margin-top: $size + rem

      > .grid, 
      &.sub-all .grid
        
        &.wrapped
          margin: ($size + em) 0 0

        &.spaced
          border-spacing: $size + em 0
          margin: ($size + em) (-$size + em) 0

          &.wrapped
            margin: ($size/2 + em) (-$size/2 + em) (-$size/2 + em) !important
            &:first-child
              margin-top: (-$size/2 + em) !important
            & > .grid-items
              & > *
                padding: ($size/2) + em
                margin: 0 !important
