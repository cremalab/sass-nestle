// Nest Generator
@function pow($number, $exp)
  $value: 1
  @if $exp > 0
    @for $i from 1 through $exp
      $value: $value * $number
  @else if $exp < 0
    @for $i from 1 through -$exp
      $value: $value / $number
  @return $value

=nestle($ratio: 1.5, $shift: -2, $steps: 6, $include_wrapped: false)

  @for $step from 1 through ($steps)
    $rank: $steps - ($step - $shift)
    $size: pow($ratio, $rank)

    .pad-#{$step}
      padding:        ($size + rem)
    .pad-h-#{$step}
      padding-right:  ($size + rem)
      padding-left:   ($size + rem)
    .pad-v-#{$step}
      padding-top:    ($size + rem)
      padding-bottom: ($size + rem)
    .pad-t-#{$step}
      padding-top:    ($size + rem)
    .pad-r-#{$step}
      padding-right:  ($size + rem)
    .pad-b-#{$step}
      padding-bottom: ($size + rem)
    .pad-l-#{$step}
      padding-left:   ($size + rem)

    .nest-#{$step}

      > *, 
      &.sub-all *
        margin-top: ($size + rem)

      > .grid, 
      &.sub-all .grid
        
        @if $include_wrapped
          &.wrapped
            margin: ($size + rem) 0 0

        &.spaced
          border-spacing: ($size + rem) 0
          margin: ($size + rem) (-$size + rem) 0

        @if $include_wrapped
          &.wrapped
            margin: (($size / 2) + rem) (-($size / 2) + rem) (-($size / 2) + rem) !important
            &:first-child
              margin-top: (-($size / 2) + rem) !important
            & > .grid-items
              & > *
                padding: (($size / 2) + rem)
                margin: 0 !important
